{"ast":null,"code":"import _extends from\"@babel/runtime/helpers/extends\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import React,{useContext,useState,useCallback}from'react';import View from\"react-native-web/dist/exports/View\";import Text from\"react-native-web/dist/exports/Text\";import ScrollView from\"react-native-web/dist/exports/ScrollView\";import Button from\"react-native-web/dist/exports/Button\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import{Container}from\"native-base\";import{useFocusEffect}from\"@react-navigation/native\";import AsyncStorage from\"@react-native-community/async-storage\";import OrderCard from\"../../Shared/OrderCard\";import axios from\"axios\";import baseURL from\"../../assets/common/baseUrl\";import AuthGlobal from\"../../Context/store/AuthGlobal\";import{logoutUser}from\"../../Context/actions/Auth.actions\";import{useEffect}from'react/cjs/react.development';var UserProfile=function UserProfile(props){var context=useContext(AuthGlobal);var _useState=useState(),_useState2=_slicedToArray(_useState,2),userProfile=_useState2[0],setUserProfile=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),orders=_useState4[0],setOrders=_useState4[1];useFocusEffect(useCallback(function(){if(context.stateUser.isAuthenticated===false||context.stateUser.isAuthenticated===null){props.navigation.navigate(\"Login\");}AsyncStorage.getItem(\"jwt\").then(function(res){axios.get(baseURL+\"users/\"+context.stateUser.user.sub,{headers:{Authorization:\"Bearer \"+res}}).then(function(user){return setUserProfile(user.data);});}).catch(function(error){return console.log(error);});axios.get(baseURL+\"orders\").then(function(x){var data=x.data;console.log(data);var userOrders=data.filter(function(order){return order.user._id===context.stateUser.user.sub;});setOrders(userOrders);}).catch(function(error){return console.log(error);});return function(){setUserProfile();setOrders();};},[context.stateUser.isAuthenticated]));return React.createElement(Container,{style:styles.container},React.createElement(ScrollView,{contentContainerStyle:styles.subContainer},React.createElement(Text,{style:{fontSize:30}},userProfile?userProfile.name:\"\"),React.createElement(View,{style:{marginTop:20}},React.createElement(Text,{style:{margin:10}},\"Email: \",userProfile?userProfile.email:\"\"),React.createElement(Text,{style:{margin:10}},\"Phone: \",userProfile?userProfile.phone:\"\")),React.createElement(View,{style:{marginTop:80}},React.createElement(Button,{title:\"Sign Out\",onPress:function onPress(){return[AsyncStorage.removeItem(\"jwt\"),logoutUser(context.dispatch)];}})),React.createElement(View,{style:styles.order},React.createElement(Text,{style:{fontSize:20}},\"My Orders\"),React.createElement(View,null,orders?orders.map(function(x){return React.createElement(OrderCard,_extends({key:x.id},x));}):React.createElement(View,{style:styles.order},React.createElement(Text,null,\"You have no orders\"))))));};var styles=StyleSheet.create({container:{flex:1,alignItems:\"center\"},subContainer:{alignItems:\"center\",marginTop:60},order:{marginTop:20,alignItems:\"center\",marginBottom:60}});export default UserProfile;","map":{"version":3,"names":["React","useContext","useState","useCallback","Container","useFocusEffect","AsyncStorage","OrderCard","axios","baseURL","AuthGlobal","logoutUser","useEffect","UserProfile","props","context","userProfile","setUserProfile","orders","setOrders","stateUser","isAuthenticated","navigation","navigate","getItem","then","res","get","user","sub","headers","Authorization","data","catch","error","console","log","x","userOrders","filter","order","_id","styles","container","subContainer","fontSize","name","marginTop","margin","email","phone","removeItem","dispatch","map","id","StyleSheet","create","flex","alignItems","marginBottom"],"sources":["D:/PTIT/do an nam 4/mobile/mern-stack-ecommerce-master/easy-shop/Screens/User/UserProfile.js"],"sourcesContent":["import React, { useContext, useState, useCallback } from 'react';\nimport { View, Text, ScrollView, Button, StyleSheet } from 'react-native';\nimport { Container } from \"native-base\"\nimport { useFocusEffect } from \"@react-navigation/native\"\nimport AsyncStorage from \"@react-native-community/async-storage\"\nimport OrderCard from \"../../Shared/OrderCard\"\n\nimport axios from \"axios\"\nimport baseURL from \"../../assets/common/baseUrl\"\n\nimport AuthGlobal from \"../../Context/store/AuthGlobal\"\nimport { logoutUser } from \"../../Context/actions/Auth.actions\"\nimport { useEffect } from 'react/cjs/react.development';\n\nconst UserProfile = (props) => {\n    const context = useContext(AuthGlobal)\n    const [userProfile, setUserProfile] = useState()\n    const [orders, setOrders] = useState()\n\n    useFocusEffect(\n        useCallback(() => {\n        if (\n            context.stateUser.isAuthenticated === false || \n            context.stateUser.isAuthenticated === null\n        ) {\n            props.navigation.navigate(\"Login\")\n        }\n\n        AsyncStorage.getItem(\"jwt\")\n            .then((res) => {\n                axios\n                    .get(`${baseURL}users/${context.stateUser.user.sub}`, {\n                        headers: { Authorization: `Bearer ${res}` },\n                    })\n                    .then((user) => setUserProfile(user.data))\n            })\n            .catch((error) => console.log(error))\n\n        axios\n        .get(`${baseURL}orders`)\n        .then((x) => {\n            const data = x.data;\n            console.log(data)\n            const userOrders = data.filter(\n                (order) => order.user._id === context.stateUser.user.sub\n            );\n            setOrders(userOrders);\n        })\n        .catch((error) => console.log(error))\n\n        return () => {\n            setUserProfile();\n            setOrders();\n        }\n\n    }, [context.stateUser.isAuthenticated]))\n\n    return (\n       <Container style={styles.container}>\n           <ScrollView contentContainerStyle={styles.subContainer}>\n               <Text style={{ fontSize: 30 }}>\n                   {userProfile ? userProfile.name : \"\" }\n               </Text>\n               <View style={{ marginTop: 20 }}>\n                    <Text style={{ margin: 10 }}>\n                        Email: {userProfile ? userProfile.email : \"\"}\n                    </Text>\n                    <Text style={{ margin: 10 }}>\n                        Phone: {userProfile ? userProfile.phone : \"\"}\n                    </Text>\n               </View>\n               <View style={{ marginTop: 80 }}>\n                    <Button title={\"Sign Out\"} onPress={() => [\n                        AsyncStorage.removeItem(\"jwt\"),\n                        logoutUser(context.dispatch)\n                    ]}/>\n               </View>\n               <View style={styles.order}>\n                   <Text style={{ fontSize: 20 }}>My Orders</Text>\n                   <View>\n                       {orders ? (\n                           orders.map((x) => {\n                               return <OrderCard key={x.id} {...x} />;\n                           })\n                       ) : (\n                           <View style={styles.order}>\n                               <Text>You have no orders</Text>\n                           </View>\n                       )}\n                   </View>\n               </View>\n           </ScrollView>\n       </Container>\n    )\n}\n\nconst styles = StyleSheet.create({\n    container: {\n        flex: 1,\n        alignItems: \"center\"\n    },\n    subContainer: {\n        alignItems: \"center\",\n        marginTop: 60\n    },\n    order: {\n        marginTop: 20,\n        alignItems: \"center\",\n        marginBottom: 60\n    }\n})\n\nexport default UserProfile;"],"mappings":"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"},"metadata":{},"sourceType":"module"}